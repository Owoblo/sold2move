<!DOCTYPE html>
<html>
<head>
    <title>Phase 1 Payment Testing</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; background: #0A192F; color: #64FFDA; }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #112240; border-radius: 8px; }
        .success { color: #4CAF50; }
        .error { color: #F44336; }
        .warning { color: #FF9800; }
        button { background: #64FFDA; color: #0A192F; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; margin: 5px; }
        button:hover { background: #4ECDC4; }
        .plan { margin: 10px 0; padding: 10px; background: #112240; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>Phase 1 Payment Testing</h1>
    
    <div class="test-section">
        <h2>Current Configuration</h2>
        <p><strong>Phase:</strong> Phase 1 (All plans default to $9.99 CAD)</p>
        <p><strong>Default Price ID:</strong> price_1SCBwSCUfCzyitr0nf5Hu5Cg</p>
        <p><strong>Mode:</strong> Live (using live Stripe keys)</p>
    </div>
    
    <div class="test-section">
        <h2>Plan Status</h2>
        <div class="plan">
            <strong>Starter Plan:</strong> $9.99 CAD → price_1SCBwSCUfCzyitr0nf5Hu5Cg
        </div>
        <div class="plan">
            <strong>Growth Plan:</strong> $9.99 CAD → price_1SCBwSCUfCzyitr0nf5Hu5Cg
        </div>
        <div class="plan">
            <strong>Scale Plan:</strong> $9.99 CAD → price_1SCBwSCUfCzyitr0nf5Hu5Cg
        </div>
        <div class="plan">
            <strong>Credit Packs:</strong> $9.99 CAD → price_1SCBwSCUfCzyitr0nf5Hu5Cg
        </div>
    </div>
    
    <div class="test-section">
        <h2>Testing Instructions</h2>
        <ol>
            <li>Visit <a href="http://localhost:5174/pricing" target="_blank">Pricing Page</a></li>
            <li>Click on any plan (Starter, Growth, Scale)</li>
            <li>Verify all plans redirect to $9.99 CAD checkout</li>
            <li>Test the payment flow with a real card</li>
            <li>Verify credits are added after successful payment</li>
        </ol>
    </div>
    
    <div class="test-section">
        <h2>Health Check</h2>
        <button onclick="testHealthCheck()">Test Health Check</button>
        <div id="healthResult"></div>
    </div>
    
    <div class="test-section">
        <h2>Phase 2 Preparation</h2>
        <p>When you're ready for Phase 2, provide the individual Stripe price IDs for:</p>
        <ul>
            <li>Starter Plan: $9.99/month</li>
            <li>Growth Plan: $29.99/month</li>
            <li>Scale Plan: $99.99/month</li>
            <li>Credit Packs: Various one-time prices</li>
        </ul>
    </div>

    <script>
        async function testHealthCheck() {
            const resultDiv = document.getElementById('healthResult');
            resultDiv.innerHTML = '<p>Testing health check...</p>';
            
            try {
                const response = await fetch('/health');
                const data = await response.json();
                
                let html = '<h3>Health Check Results:</h3>';
                html += `<p><strong>Overall Status:</strong> <span class="${data.overall === 'healthy' ? 'success' : 'error'}">${data.overall}</span></p>`;
                
                if (data.checks && data.checks.payment) {
                    const payment = data.checks.payment;
                    html += `<p><strong>Payment Status:</strong> <span class="${payment.status === 'healthy' ? 'success' : 'error'}">${payment.status}</span></p>`;
                    html += `<p><strong>Mode:</strong> ${payment.testMode ? 'Test' : 'Live'}</p>`;
                    
                    if (payment.plans) {
                        html += '<h4>Plan Status:</h4>';
                        for (const [plan, status] of Object.entries(payment.plans)) {
                            const statusClass = status === 'working' ? 'success' : status === 'requires_auth' ? 'warning' : 'error';
                            html += `<p><strong>${plan}:</strong> <span class="${statusClass}">${status}</span></p>`;
                        }
                    }
                }
                
                resultDiv.innerHTML = html;
            } catch (error) {
                resultDiv.innerHTML = `<p class="error">Error: ${error.message}</p>`;
            }
        }
    </script>
</body>
</html>
